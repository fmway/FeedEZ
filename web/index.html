<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Feeder Otomatis</title>
  <!-- Link Google Fonts untuk Poppins -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      text-align: center;
      background-color: #e9f5e9;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
    }
    .container {
      width: 90%;
      max-width: 400px;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
    }
    .time {
      font-size: 48px;
      font-weight: 700;
    }
    .button {
      width: 100%;
      padding: 15px;
      margin: 10px 0;
      border: none;
      color: white;
      font-size: 16px;
      cursor: pointer;
      border-radius: 5px;
    }
    .feed-now { background-color: #d9534f; }
    .schedule { background-color: #5cb85c; }
    .settings { background-color: #6c757d; }
    .edit { background-color: #f0ad4e; }
    .hidden { display: none; }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 10px 0;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: center;
    }
    th { 
      background-color: #5cb85c;
      color: white; 
    }
    input {
      padding: 5px;
      text-align: center;
      border: 1px solid #ddd;
      box-sizing: border-box;
    }
    input[type="time"] {
      width: 90%;
      max-width: 80px;
      margin: 0 auto;
      display: block;
    }
    /* Styling untuk round slider (circular slider) */
    #knobCanvas {
      margin: 20px auto;
      display: block;
      cursor: pointer;
      background-color: #f9f9f9;
      border-radius: 50%;
    }
    /* Styling untuk tombol panah */
    #arrowContainer {
      width: 150px;
      margin: 20px auto 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .arrow-button {
      font-size: 24px;
      padding: 0;
      background: linear-gradient(45deg, #FF9800, #F44336);
      color: white;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      transition: transform 0.2s, background 0.3s;
    }
    .arrow-button:hover {
      transform: scale(1.1);
      background: linear-gradient(45deg, #E65100, #C62828);
    }
  </style>
</head>
<body>
  <!-- Tampilan Utama -->
  <div class="container" id="mainScreen">
    <h2>Pakan Selanjutnya</h2>
    <div class="time" id="feedTime">14:00</div>
    <button class="button feed-now" onclick="feedNow()">Jalankan Sekarang</button>
    <button class="button schedule" onclick="showSchedule()">Lihat Jadwal</button>
    <button class="button settings" onclick="openSettings()">Pengaturan</button>
  </div>

  <!-- Tampilan Lihat Jadwal -->
  <div class="container hidden" id="scheduleScreen">
    <h2>Jadwal Pakan</h2>
    <table id="scheduleTable">
      <tr>
        <th>Hari</th>
        <th>Pagi</th>
        <th>Siang</th>
        <th>Malam</th>
      </tr>
      <tr><td>Senin</td><td>08:00</td><td>14:00</td><td>20:00</td></tr>
      <tr><td>Selasa</td><td>08:00</td><td>14:00</td><td>20:00</td></tr>
      <tr><td>Rabu</td><td>08:00</td><td>14:00</td><td>20:00</td></tr>
      <tr><td>Kamis</td><td>08:00</td><td>14:00</td><td>20:00</td></tr>
      <tr><td>Jumat</td><td>08:00</td><td>14:00</td><td>20:00</td></tr>
      <tr><td>Sabtu</td><td>08:00</td><td>14:00</td><td>20:00</td></tr>
      <tr><td>Minggu</td><td>08:00</td><td>14:00</td><td>20:00</td></tr>
    </table>
    <button class="button edit" id="editButton" onclick="toggleEditSchedule()">Edit Jadwal</button>
    <button class="button settings" onclick="goBack()">Kembali</button>
  </div>

  <!-- Tampilan Pengaturan -->
  <div class="container hidden" id="settingsScreen">
    <h2>Pengaturan Pelontar Pakan</h2>
    <p>Pilih kecepatan pelontar dengan memutar slider:</p>
    <canvas id="knobCanvas" width="150" height="150"></canvas>
    <!-- Tombol panah untuk mengubah speed -->
    <div id="arrowContainer">
      <button class="arrow-button" onclick="decreaseSpeed()">&#9664;</button>
      <button class="arrow-button" onclick="increaseSpeed()">&#9654;</button>
    </div>
    <p id="speedDisplay">Kecepatan: Level 1</p>
    <button class="button settings" onclick="saveSettings()">Simpan Pengaturan</button>
    <button class="button settings" onclick="backToMain()">Kembali</button>
  </div>

  <script>
    var isEditing = false;
    var currentSpeed = 1; // Level 1 sampai 5

    // Fungsi untuk menginterpolasi warna dari hijau ke merah (Level 1: hijau, Level 5: merah)
    function getLevelColor(level) {
      var t = (level - 1) / 4; // 0 untuk level 1, 1 untuk level 5
      var r = Math.round(255 * t);
      var g = Math.round(255 * (1 - t));
      var b = 0;
      return "rgb(" + r + "," + g + "," + b + ")";
    }
    
    function feedNow() {
      alert("Pakan diberikan sekarang!");
    }
    
    function showSchedule() {
      hideAll();
      document.getElementById('scheduleScreen').classList.remove('hidden');
    }
    
    function openSettings() {
      hideAll();
      document.getElementById('settingsScreen').classList.remove('hidden');
      drawSlider();
    }
    
    function backToMain() {
      hideAll();
      document.getElementById('mainScreen').classList.remove('hidden');
    }
    
    function goBack() {
      if (isEditing) {
        toggleEditSchedule(true);
      }
      hideAll();
      document.getElementById('mainScreen').classList.remove('hidden');
    }
    
    // Fungsi untuk menyembunyikan semua tampilan
    function hideAll() {
      document.getElementById('mainScreen').classList.add('hidden');
      document.getElementById('scheduleScreen').classList.add('hidden');
      document.getElementById('settingsScreen').classList.add('hidden');
    }
    
    // Fungsi toggle edit jadwal (tetap sama seperti sebelumnya)
    function toggleEditSchedule(revertOnly) {
      var table = document.getElementById("scheduleTable");
      var editButton = document.getElementById("editButton");
      
      if (!isEditing) {
        for (var i = 1; i < table.rows.length; i++) {
          for (var j = 1; j < table.rows[i].cells.length; j++) {
            var cell = table.rows[i].cells[j];
            var currentValue = cell.textContent.trim();
            cell.innerHTML = '<input type="time" value="' + currentValue + '">';
          }
        }
        editButton.textContent = "Simpan Jadwal";
        isEditing = true;
      } else {
        for (var i = 1; i < table.rows.length; i++) {
          for (var j = 1; j < table.rows[i].cells.length; j++) {
            var cell = table.rows[i].cells[j];
            var input = cell.querySelector("input");
            if (input) {
              var newValue = input.value;
              cell.innerHTML = newValue;
            }
          }
        }
        editButton.textContent = "Edit Jadwal";
        isEditing = false;
        if (!revertOnly) {
          alert("Jadwal telah diperbarui!");
        }
      }
    }
    
    function saveSettings() {
      alert("Pengaturan disimpan! Kecepatan pelontar: Level " + currentSpeed);
      backToMain();
    }
    
    // --- Kode untuk Round Slider (Circular Slider) dengan tampilan yang lebih menarik ---
    function drawSlider() {
      var canvas = document.getElementById("knobCanvas");
      var ctx = canvas.getContext("2d");
      var centerX = canvas.width / 2;
      var centerY = canvas.height / 2;
      var radius = 60;
      
      // Bersihkan canvas dan isi background untuk menghindari artefak
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.fillStyle = "#f9f9f9";
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      
      // Definisikan sudut awal dan akhir untuk slider (dalam radian)
      var startAngle = (-135 * Math.PI) / 180;  // -135°
      var endAngle = (135 * Math.PI) / 180;       // +135°
      
      // Gambar track penuh dengan gradient dan bayangan
      ctx.save();
      ctx.shadowColor = "rgba(0, 0, 0, 0.15)";
      ctx.shadowBlur = 8;
      ctx.beginPath();
      ctx.arc(centerX, centerY, radius, startAngle, endAngle);
      ctx.lineWidth = 12;
      // Buat gradient radial untuk track
      var trackGradient = ctx.createRadialGradient(centerX, centerY, radius - 10, centerX, centerY, radius + 10);
      trackGradient.addColorStop(0, "#eee");
      trackGradient.addColorStop(1, "#bbb");
      ctx.strokeStyle = trackGradient;
      ctx.stroke();
      ctx.restore();
      
      // Hitung sudut untuk level yang dipilih
      var totalArc = endAngle - startAngle; // 270° dalam radian
      var stepAngle = totalArc / 4;          // 4 interval untuk 5 level
      var currentAngle = startAngle + (currentSpeed - 1) * stepAngle;
      
      // Gambar arc progress dengan warna sesuai level
      ctx.save();
      ctx.beginPath();
      ctx.arc(centerX, centerY, radius, startAngle, currentAngle);
      ctx.lineWidth = 12;
      ctx.strokeStyle = getLevelColor(currentSpeed);
      ctx.stroke();
      ctx.restore();
      
      // Gambar tick mark dan marker angka untuk tiap level
      for (var level = 1; level <= 5; level++) {
        var tickAngle = startAngle + (level - 1) * stepAngle;
        ctx.save();
        ctx.beginPath();
        var tickStartX = centerX + (radius - 5) * Math.cos(tickAngle);
        var tickStartY = centerY + (radius - 5) * Math.sin(tickAngle);
        var tickEndX = centerX + (radius + 5) * Math.cos(tickAngle);
        var tickEndY = centerY + (radius + 5) * Math.sin(tickAngle);
        ctx.moveTo(tickStartX, tickStartY);
        ctx.lineTo(tickEndX, tickEndY);
        ctx.strokeStyle = "#333";
        ctx.lineWidth = 2;
        ctx.stroke();
        ctx.restore();
        
        // Gambar marker angka
        ctx.save();
        var markerX = centerX + (radius + 20) * Math.cos(tickAngle);
        var markerY = centerY + (radius + 20) * Math.sin(tickAngle);
        ctx.font = "bold 16px Poppins";
        ctx.fillStyle = "#333";
        ctx.textAlign = "center";
        ctx.textBaseline = "middle";
        ctx.fillText(level, markerX, markerY);
        ctx.restore();
      }
      
      // Gambar handle (bulatan kecil) di ujung arc progress
      ctx.save();
      var handleX = centerX + radius * Math.cos(currentAngle);
      var handleY = centerY + radius * Math.sin(currentAngle);
      // Buat gradient untuk handle agar terlihat tiga dimensi
      var handleGradient = ctx.createRadialGradient(handleX, handleY, 2, handleX, handleY, 8);
      handleGradient.addColorStop(0, "#fff");
      handleGradient.addColorStop(1, getLevelColor(currentSpeed));
      ctx.beginPath();
      ctx.arc(handleX, handleY, 8, 0, 2 * Math.PI);
      ctx.fillStyle = handleGradient;
      ctx.fill();
      ctx.strokeStyle = "#333";
      ctx.lineWidth = 2;
      ctx.stroke();
      ctx.restore();
      
      // Tampilkan teks level di tengah slider dengan sedikit bayangan
      ctx.save();
      ctx.font = "bold 20px Poppins";
      ctx.textAlign = "center";
      ctx.textBaseline = "middle";
      ctx.shadowColor = "rgba(0,0,0,0.3)";
      ctx.shadowBlur = 4;
      ctx.fillStyle = "#000";
      ctx.fillText("L " + currentSpeed, centerX, centerY);
      ctx.restore();
      
      // Perbarui tampilan teks di bawah slider
      document.getElementById("speedDisplay").textContent = "Kecepatan: Level " + currentSpeed;
    }
    
    // Fungsi untuk mengubah level dengan tombol panah
    function decreaseSpeed() {
      if (currentSpeed > 1) {
        currentSpeed--;
        drawSlider();
      }
    }
    function increaseSpeed() {
      if (currentSpeed < 5) {
        currentSpeed++;
        drawSlider();
      }
    }
    
    // Event listener untuk klik pada slider
    document.getElementById("knobCanvas").addEventListener("click", function(e) {
      var canvas = this;
      var rect = canvas.getBoundingClientRect();
      var x = e.clientX - rect.left;
      var y = e.clientY - rect.top;
      var centerX = canvas.width / 2;
      var centerY = canvas.height / 2;
      // Hitung sudut klik relatif terhadap pusat (dalam radian)
      var clickAngle = Math.atan2(y - centerY, x - centerX);
      // Klamp sudut ke rentang slider: antara -135° dan +135°
      var minAngle = (-135 * Math.PI) / 180;
      var maxAngle = (135 * Math.PI) / 180;
      if (clickAngle < minAngle) clickAngle = minAngle;
      if (clickAngle > maxAngle) clickAngle = maxAngle;
      // Tentukan level secara diskrit
      var totalArc = maxAngle - minAngle;
      var step = totalArc / 4;
      var level = Math.round((clickAngle - minAngle) / step) + 1;
      if (level < 1) level = 1;
      if (level > 5) level = 5;
      currentSpeed = level;
      drawSlider();
    });
    
    // Gambar awal slider
    drawSlider();
  </script>
</body>
</html>
